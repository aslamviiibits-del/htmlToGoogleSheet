<!DOCTYPE html>
<html>
<head>
  <title>Google Sheet Record Creator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    form { max-width: 400px; margin: auto; }
    input, textarea, button {
      width: 100%; padding: 10px; margin: 8px 0;
      border: 1px solid #ccc; border-radius: 4px;
    }
    button { background: #28a745; color: white; border: none; cursor: pointer; }
    button:hover { background: #218838; }
  </style>
</head>
<body>
  <h2>Create Record in Google Sheet</h2>
  <form id="recordForm">
    <input type="text" name="name" id="name" placeholder="Enter Name" required>
    <input type="email" name="email" id="email" placeholder="Enter Email" required>
    <textarea name="message" id="message" placeholder="Enter Message" required></textarea>
    <button type="submit">Submit</button>
  </form>

  <p id="status"></p>

  <script>
    const scriptURL = "https://script.google.com/macros/library/d/1lxy4rr9F0SNRKtxyWl64BBO6obyZnQx7HC6cHhXMhytUNKrlvGsTVIQf/5"; 
    // üëÜ Replace with your Web App URL

    const form = document.getElementById("recordForm");
    const status = document.getElementById("status");

    form.addEventListener("submit", e => {
      e.preventDefault();
      status.innerText = "‚è≥ Submitting...";

      const formData = new FormData(form);

      fetch(scriptURL, { method: "POST", body: formData })
        .then(response => response.text())
        .then(text => {
          console.log("Raw response:", text);
          try {
            const res = JSON.parse(text);
            if (res.result === "success") {
              status.innerText = "‚úÖ Record added!";
              form.reset();
            } else {
              status.innerText = "‚ùå Server error: " + res.message;
            }
          } catch {
            // If Apps Script just returns "Success"
            if (text.includes("Success")) {
              status.innerText = "‚úÖ Record added!";
              form.reset();
            } else {
              status.innerText = "‚ö†Ô∏è Unexpected response: " + text;
            }
          }
        })
        .catch(err => {
          status.innerText = "‚ùå Network error: " + err.message;
          console.error("Fetch error:", err);
        });
    });
  </script>
</body>
</html>



